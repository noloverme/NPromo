# NPromo - Руководство по использованию

NPromo — это плагин для серверов Minecraft (Paper/Purpur 1.16+), который добавляет мощную и гибкую систему промокодов. Это руководство поможет вам понять, установить и настроить все его возможности.

## 1. Установка

1.  **Скачайте** последнюю версию плагина.
2.  **Поместите** скачанный `.jar` файл в папку `plugins` вашего сервера.
3.  **Перезапустите** или **запустите** сервер.

При первом запуске плагин автоматически создаст три конфигурационных файла в папке `/plugins/NPromo/`:
- `config.yml` — основной файл конфигурации.
- `messages.yml` — файл для настройки всех сообщений.
- `codes.yml` — файл для создания и настройки промокодов.

## 2. Основная настройка (`config.yml`)

Этот файл содержит глобальные настройки плагина.

### 2.1. Режимы работы

Плагин имеет два режима активации кодов, которые устанавливаются в параметре `mode`:

- **`UNLIMITED`** (режим по умолчанию)
  - **Описание:** Игроки могут активировать сколько угодно *разных* промокодов. Каждый конкретный промокод можно использовать только один раз.
  - **Пример:** Игрок может активировать и `START`, и `NEWYEAR`, но не может активировать `START` дважды.

- **`MEDIA`**
  - **Описание:** Игроки могут активировать только **один** любой промокод за всё время игры на сервере. Этот режим идеально подходит для акций, где каждый игрок должен получить только одну награду (например, для новых игроков с YouTube).
  - **Дополнительная настройка:** В секции `media-settings` можно включить `check-ip: true`. Если эта опция активна, плагин не позволит активировать промокод, если с этого IP-адреса уже была произведена активация (даже другим аккаунтом).

### 2.2. Настройка базы данных

Плагин хранит данные об активированных кодах в базе данных. Вы можете выбрать тип хранилища в секции `storage`.

- **`H2`** (локальная база данных)
  - **Описание:** Это вариант по умолчанию. Он не требует никаких дополнительных настроек. Все данные будут храниться в файле `data.db` в папке плагина. Идеально для небольших серверов.
  - **Настройка:**
    ```yaml
    storage:
      type: H2
    ```

- **`MySQL`** (внешняя база данных)
  - **Описание:** Рекомендуется для крупных серверов или сетей серверов (BungeeCord/Velocity), так как позволяет синхронизировать данные между несколькими серверами.
  - **Настройка:** Укажите `type: MYSQL` и введите данные для подключения к вашей базе данных в секции `mysql`.
    ```yaml
    storage:
      type: MYSQL
      mysql:
        host: "localhost"
        port: 3306
        database: "npromo"
        username: "root"
        password: ""
    ```

## 3. Создание промокодов (`codes.yml`)

Это главный файл для управления вашими промокодами. Здесь вы определяете сам код, награды и сообщения.

### Структура промокода

```yaml
# Название промокода (то, что вводят игроки)
PROMO1:
  # (Опционально) Сообщение, которое игрок увидит при успешной активации.
  # Если эту секцию удалить, будет использовано стандартное сообщение из messages.yml.
  successfully: "&aВы успешно активировали промокод 'PROMO1'!"

  # (Опционально) Команды, которые будут выполнены от имени консоли.
  # Используйте плейсхолдер %player% для подстановки ника игрока.
  cmds:
    - "eco give %player% 1000"
    - "kit give starter %player%"
    - "say &e%player% &aактивировал крутой промокод!"

# Другой пример, без кастомного сообщения
START:
  cmds:
    - "give %player% diamond_sword 1"
    - "give %player% cooked_beef 32"
```

- Вы можете создать сколько угодно промокодов, просто добавляя новые секции в файл.
- Если промокоду не нужны команды или специальное сообщение, вы можете просто оставить пустую секцию (например, `MYCODE:`). Такой код можно будет активировать, но он ничего не даст.

## 4. Настройка сообщений (`messages.yml`)

В этом файле вы можете перевести или изменить абсолютно все сообщения, которые плагин отправляет игрокам и администраторам. Файл изначально переведен на русский язык.

- **`prefix`**: Префикс, который добавляется ко всем сообщениям плагина.
- **Поддержка цветов**: Вы можете использовать стандартные цветовые коды с символом `&` (например, `&a`, `&l`) и HEX-цвета в формате `&#RRGGBB` (например, `&#FF0000` для красного).

## 5. Команды

### Для игроков

- `/code <code>` (или `/ncode`, `/promo`, `/promocode`)
  - **Описание:** Основная команда для активации промокода.
  - **Права:** Не требуются.

### Для администраторов

- `/ncodes reload`
  - **Описание:** Перезагружает все конфигурационные файлы (`config.yml`, `messages.yml`, `codes.yml`). **Используйте эту команду после внесения изменений в файлы.**
  - **Права:** `ncodes.admin`

- `/ncodes check <ник>`
  - **Описание:** Позволяет посмотреть, какие промокоды уже активировал указанный игрок.
  - **Права:** `ncodes.admin`

- `/ncodes statspromo <code>`
  - **Описание:** Показывает, сколько раз был активирован указанный промокод.
  - **Права:** `ncodes.admin`

## 6. Интеграция с PlaceholderAPI

Если на вашем сервере установлен плагин `PlaceholderAPI`, вы можете использовать плейсхолдеры от NPromo.

- **`%ncodes_activations_<code>%`**
  - **Описание:** Выводит количество активаций для указанного промокода.
  - **Пример:** Если вы хотите показать в табе, сколько раз активировали код `START`, используйте плейсхолдер `%ncodes_activations_START%`.
  - **Результат:** `123`
